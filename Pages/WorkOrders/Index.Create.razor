@using PrintingJobTracker.Shared
@using Microsoft.AspNetCore.Components.Forms
@page "/workorders/new"
@inject IWorkOrdersService WorkOrdersService
@using System.ComponentModel.DataAnnotations

<h1>Create Job</h1>

<EditForm Model="model" OnValidSubmit="CreateAsync">
    <DataAnnotationsValidator />
    <ValidationSummary />

    <div class="mb-3">
        <label class="form-label">Client Name</label>
        <InputText class="form-control" @bind-Value="model.ClientName" />
    </div>

    <div class="mb-3">
        <label class="form-label">Job Name</label>
        <InputText class="form-control" @bind-Value="model.JobName" />
    </div>

    <div class="mb-3">
        <label class="form-label">Quantity</label>
        <InputNumber class="form-control" @bind-Value="model.Quantity" />
    </div>

    <div class="mb-3">
        <label class="form-label">Carrier</label>
        <InputSelect class="form-select" @bind-Value="model.Carrier">
            <option>USPS</option>
            <option>UPS</option>
            <option>FedEx</option>
        </InputSelect>
    </div>

    <div class="mb-3">
        <label class="form-label">SLA Mail By</label>
        <InputDate class="form-control" @bind-Value="model.SLA_MailBy" />
    </div>

    <button class="btn btn-primary" type="submit">Save</button>
    <a class="btn btn-secondary ms-2" href="/workorders">Cancel</a>
</EditForm>

@code {
    private Job model = new Job { Quantity = 1000, Carrier = "USPS", SLA_MailBy = DateTime.UtcNow.AddDays(7)};

    private async Task CreateAsync()
    {
        await WorkOrdersService.CreateJobAsync(model);
        // navigate back
        Microsoft.AspNetCore.Components.NavigationManager? nav = this.Navigation;
        Navigation.NavigateTo("/workorders");
    }

    [Inject] public NavigationManager Navigation { get; set; } = default!;
}
